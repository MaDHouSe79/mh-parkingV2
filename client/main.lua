--[[ ===================================================== ]] --
--[[          MH Realistic Parking V2 by MaDHouSe79        ]] --
--[[ ===================================================== ]] --
LocalVehicles, GlobalVehicles, isLoggedIn, SpawnedVehicles, DeletingEntities, displayOwnerText = {}, {}, {}, false, false, false
AddEventHandler('onResourceStop', function(resource) Parking.Functions.DeleteAllVehicles() PlayerData = {} config = nil isLoggedIn = false end)
AddEventHandler('onResourceStart', function(resource) if resource == GetCurrentResourceName() then TriggerServerEvent('mh-parkingV2:server:onjoin') end end)
RegisterNetEvent(OnPlayerLoaded, function()	TriggerServerEvent('mh-parkingV2:server:onjoin') end)
RegisterNetEvent(OnPlayerUnload, function()	Parking.Functions.DeleteAllVehicles() PlayerData = {} config = nil isLoggedIn = false end)
RegisterNetEvent("mh-parkingV2:client:onjoin", function(data) config = data PlayerData = GetPlayerData() isLoggedIn = true displayOwnerText = config.UseVehicleOwnerText end)
RegisterNetEvent("mh-parkingV2:client:refreshVehicles", function(vehicles) Parking.Functions.RefreshVehicles(vehicles) end)
RegisterNetEvent("mh-parkingV2:client:addVehicle", function(vehicle, playerId) Parking.Functions.AddVehicle(vehicle, playerId) end)
RegisterNetEvent("mh-parkingV2:client:deleteVehicle", function(vehicle) Parking.Functions.DeleteLocalVehicle(vehicle) end)
RegisterNetEvent("mh-parkingV2:client:CreateOwnerVehicleBlip", function(data) Parking.Functions.CreateOwnerVehicleBlip(data) end)
RegisterNetEvent("mh-parkingV2:client:unparking", function() Parking.Functions.TargetDrive() end)
RegisterNetEvent("mh-parkingV2:client:parking", function() Parking.Functions.TargetPark() end)
RegisterNetEvent('mh-parkingV2:client:GetVehicleMenu', function() Parking.Functions.GetVehicleMenu() end)
RegisterCommand('toggleparktext', function() displayOwnerText = not displayOwnerText end, false)
RegisterCommand('parkmenu', function() TriggerEvent('mh-parkingV2:client:GetVehicleMenu') end, false)
CreateThread(function() while true do if isLoggedIn and displayOwnerText then Parking.Functions.DisplayVehicleOwnerText() end Wait(0) end end)
CreateThread(function() while true do Wait(2000) if isLoggedIn then if #LocalVehicles ~= 0 then Parking.Functions.MakeVehiclesVisable() end end end end)
CreateThread(function() while true do Wait(3000) if isLoggedIn then if #LocalVehicles ~= 0 then Parking.Functions.CheckDistanceToForceGrounded() end end end end)
CreateThread(function()	while true do if isLoggedIn then if #LocalVehicles ~= 0 then Parking.Functions.UpdateVehicleStatus() end collectgarbage("collect") end Wait(1000) end end)
CreateThread(function() Parking.Functions.SpawnVehicleChecker() end)
CreateThread(function() Parking.Functions.DriveOrPark() end)
CreateThread(function() Parking.Functions.CheckSteeringAngle() end)
CreateThread(function() Parking.Functions.RadialMenu() end)
CreateThread(function() Parking.Functions.CreateBlips() end)